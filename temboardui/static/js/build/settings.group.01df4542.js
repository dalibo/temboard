(window.webpackJsonp=window.webpackJsonp||[]).push([["settings.group"],{"./temboardui/static/js/temboard.settings.group.js":function(e,t,o){"use strict";o.r(t);var s=o("./node_modules/datatables.net-bs4/js/dataTables.bootstrap4.js"),r=o.n(s);o("./node_modules/datatables.net-bs4/css/dataTables.bootstrap4.css");function a(e,t,o){$.ajax({url:"/json/settings/group/"+t+"/"+o,type:"get",beforeSend:function(t){$("#"+e+"Label").html("Processing, please wait..."),$("#"+e+"Info").html(""),$("#"+e+"Body").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),$("#"+e+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(o){"role"==o.kind?$("#"+e+"Label").html("Update user group properties"):$("#"+e+"Label").html("Update instance group properties");var s="";if(s+='<form id="formUpdateGroup">',s+='  <input type="hidden" id="inputGroupname" value="'+o.name+'" />',s+='  <div class="row">',s+='    <div class="form-group col-sm-6">',s+='      <label for="inputNewGroupname" class="control-label">Group name</label>',s+='      <input type="text" class="form-control" id="inputNewGroupname" placeholder="New group name" value="'+o.name+'" />',s+="    </div>","instance"==t){s+='    <div class="form-group col-sm-6">',s+='      <label for="selectGroups" class="control-label">User groups</label><br />',s+='      <select id="selectGroups" multiple="multiple">';var r={},a="";for(var n in o.user_groups)a="",o.in_groups.indexOf(n.name)>-1&&(a="selected"),s+='      <option value="'+n.name+'" '+a+">"+n.name+"</option>",r[n.name]=n.description;s+="      </select>",s+='      <p class="form-text text-muted">Please select the user groups allowed to view instances from this instance group.</p>',s+="    </div>"}s+="  </div>",s+='  <div class="row">',s+='    <div class="form-group col-sm-12">',s+='      <label for="inputDescription" class="control-label">Description</label>',s+='      <textarea class="form-control" rows="3" placeholder="Description" id="inputDescription">'+o.description+"</textarea>",s+="    </div>",s+="  </div>",s+="</form>";$("#"+e+"Body").html(s),$("#"+e+"Footer").html('<button type="submit" id="submitFormUpdateGroup" class="btn btn-success">Save</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),"instance"==t&&($("#selectGroups").multiselect(),$(".multiselect-container li").not(".filter, .group").tooltip({placement:"right",container:"body",title:function(){var e=$(this).find("input").val();return r[e]}})),$("#submitFormUpdateGroup").click(function(){$("#formUpdateGroup").submit()}),$("#formUpdateGroup").submit(function(t){t.preventDefault(),function(e,t){var o=$("#inputGroupname").val();if("instance"==t)var s=JSON.stringify({new_group_name:$("#inputNewGroupname").val(),description:$("#inputDescription").val(),user_groups:$("#selectGroups").val()});else var s=JSON.stringify({new_group_name:$("#inputNewGroupname").val(),description:$("#inputDescription").val()});$.ajax({url:"/json/settings/group/"+t+"/"+o,type:"post",beforeSend:function(t){$("#"+e+"Label").html("Processing, please wait..."),$("#"+e+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>')},data:s,async:!0,contentType:"application/json",dataType:"json",success:function(t){$("#"+e).modal("hide");var o=window.location.href;window.location.replace(o)},error:function(o){"role"==t?$("#"+e+"Label").html("Update user group properties"):$("#"+e+"Label").html("Update instance group properties"),$("#"+e+"Info").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+JSON.parse(o.responseText).error+"</div></div></div>")}})}(e,o.kind)})},error:function(o){"role"==t?$("#"+e+"Label").html("Update user group properties"):$("#"+e+"Label").html("Update instance group properties"),$("#"+e+"Body").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+JSON.parse(o.responseText).error+"</div></div>")}})}function n(e,t,o){$.ajax({url:"/json/settings/group/"+t+"/"+o,type:"get",beforeSend:function(t){$("#"+e+"Label").html("Processing, please wait..."),$("#"+e+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),$("#"+e+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(o){$("#"+e+"Info").hide(),"role"==t?$("#"+e+"Label").html("Delete user group properties"):$("#"+e+"Label").html("Delete instance group properties");$("#"+e+"Body").html(""),$("#"+e+"Footer").html('<button type="submit" id="buttonDeleteGroup" class="btn btn-danger">Yes, delete this group</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),$("#buttonDeleteGroup").click(function(t){t.preventDefault(),function(e,t,o){$.ajax({url:"/json/settings/delete/group/"+t,type:"post",beforeSend:function(t){$("#"+e+"Label").html("Processing, please wait..."),$("#"+e+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),$("#"+e+"Body").html("")},async:!0,contentType:"application/json",dataType:"json",data:JSON.stringify({group_name:o}),success:function(t){$("#"+e).modal("hide");var o=window.location.href;window.location.replace(o)},error:function(o){"role"==t?$("#"+e+"Label").html("Delete user group confirmation"):$("#"+e+"Label").html("Delete instance group confirmation"),$("#"+e+"Info").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+JSON.parse(o.responseText).error+"</div></div></div>"),$("#"+e+"Body").html("")}})}(e,o.kind,o.name)})},error:function(o){"role"==t?$("#"+e+"label").html("Delete user group confirmation"):$("#"+e+"label").html("Delete instance group confirmation"),$("#"+e+"Info").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+JSON.parse(o.responseText).error+"</div></div></div>"),$("#"+e+"Body").html(""),$("#"+e+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')}})}function l(e,t){if("instance"==t)var o=JSON.stringify({new_group_name:$("#inputNewGroupname").val(),description:$("#inputDescription").val(),user_groups:$("#selectGroups").val()});else o=JSON.stringify({new_group_name:$("#inputNewGroupname").val(),description:$("#inputDescription").val()});$.ajax({url:"/json/settings/group/"+t,type:"post",beforeSend:function(t){$("#"+e+"Label").html("Processing, please wait..."),$("#"+e+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>')},data:o,async:!0,contentType:"application/json",dataType:"json",success:function(t){$("#"+e).modal("hide");var o=window.location.href;window.location.replace(o)},error:function(o){"role"==t?$("#"+e+"Label").html("Add a new user group"):$("#"+e+"Label").html("Add a new instance group"),$("#"+e+"Info").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+JSON.parse(o.responseText).error+"</div></div></div>")}})}r()(window,$),$(document).ready(function(){$("#tableGroups").DataTable({stateSave:!0}),$("#buttonLoadAddGroupForm").click(function(){var e,t;$("#GroupModal").modal("show"),$("[data-toggle=popover]").popover("hide"),e="GroupModal","role"==(t="{{group_kind}}")?($("#"+e+"Label").html("Add a new user group"),$("#"+e+"Info").html(""),$("#"+e+"Body").html('<form id="formAddGroup">  <div class="row">    <div class="form-group col-sm-12">      <label for="inputNewGroupname" class="control-label">Group name</label>      <input type="text" class="form-control" id="inputNewGroupname" placeholder="Group name" />    </div>  </div>  <div class="row">    <div class="form-group col-sm-12">      <label for="inputDescription" class="control-label">Description</label>      <textarea class="form-control" rows="3" placeholder="Description" id="inputDescription"></textarea>    </div>  </div></form>'),$("#"+e+"Footer").html('<button type="submit" id="submitFormAddGroup" class="btn btn-success">Save</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),$("#submitFormAddGroup").click(function(){$("#formAddGroup").submit()}),$("#formAddGroup").submit(function(o){o.preventDefault(),l(e,t)})):$.ajax({url:"/json/settings/all/group/role",type:"get",beforeSend:function(t){$("#"+e+"Label").html("Processing, please wait..."),$("#"+e+"Info").html(""),$("#"+e+"Body").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),$("#"+e+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(o){$("#"+e+"Label").html("Add a new instance group"),$("#"+e+"Info").html("");var s="";s+='<form id="formAddGroup">',s+='  <div class="row">',s+='    <div class="form-group col-sm-6">',s+='      <label for="inputNewGroupname" class="control-label">Group name</label>',s+='      <input type="text" class="form-control" id="inputNewGroupname" placeholder="New group name" />',s+="    </div>",s+='    <div class="form-group col-sm-6">',s+='      <label for="selectGroups" class="control-label">User groups</label><br />',s+='      <select id="selectGroups" multiple="multiple">';var r={};for(var a in o.groups)s+='      <option value="'+a.name+'">'+a.name+"</option>",r[a.name]=a.description;s+="      </select>",s+='      <p class="form-text text-muted">Please select the user groups allowed to view instances from this instance group.</p>',s+="    </div>",s+="  </div>",s+='  <div class="row">',s+='    <div class="form-group col-sm-12">',s+='      <label for="inputDescription" class="control-label">Description</label>',s+='      <textarea class="form-control" rows="3" placeholder="Description" id="inputDescription"></textarea>',s+="    </div>",s+="  </div>",s+="</form>",$("#"+e+"Body").html(s),$("#"+e+"Footer").html('<button type="submit" id="submitFormAddGroup" class="btn btn-success">Save</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),$("#selectGroups").multiselect(),$(".multiselect-container li").not(".filter, .group").tooltip({placement:"right",container:"body",title:function(){var e=$(this).find("input").val();return r[e]}}),$("#submitFormAddGroup").click(function(){$("#formAddGroup").submit()}),$("#formAddGroup").submit(function(o){o.preventDefault(),l(e,t)})},error:function(t){$("#"+e+"Label").html("Add a new instance group"),$("#"+e+"Info").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+escapeHtml(JSON.parse(t.responseText).error)+"</div></div></div>")}})}),$(document).on("click","[data-action=edit]",function(){$("#GroupModal").modal("show"),$("[data-toggle=popover]").popover("hide"),a("GroupModal","{{group_kind}}",$(this).data("group_name"))}),$(document).on("click","[data-action=delete]",function(){$("#GroupModal").modal("show"),$("[data-toggle=popover]").popover("hide"),n("GroupModal","{{group_kind}}",$(this).data("group_name"))})})}},[["./temboardui/static/js/temboard.settings.group.js","runtime","vendors~activity~notifications~settings.group~settings.instance~settings.user"]]]);
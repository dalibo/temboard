(window.webpackJsonp=window.webpackJsonp||[]).push([["settings.user"],{"./temboardui/static/js/temboard.settings.user.js":function(e,t,s){"use strict";s.r(t),function(e){var t=s("./node_modules/datatables.net-bs4/js/dataTables.bootstrap4.js"),o=s.n(t);s("./node_modules/datatables.net-bs4/css/dataTables.bootstrap4.css");function l(t,s){e.ajax({url:"/json/settings/user/"+s,type:"get",beforeSend:function(s){e("#"+t+"Label").html("Processing, please wait..."),e("#"+t+"Info").html(""),e("#"+t+"Body").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),e("#"+t+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(s){e("#"+t+"Label").html("Update user properties");var o="";o+='<form id="formUpdateUser">',o+='  <input type="hidden" id="inputUsername" value="'+s.role_name+'" />',o+='  <div class="row">',o+='    <div class="form-group col-sm-6">',o+='      <label for="inputNewUsername" class="control-label">Username</label>',o+='      <input type="text" class="form-control" id="inputNewUsername" placeholder="New Username" value="'+s.role_name+'" />',o+="    </div>",o+='    <div class="form-group col-sm-6">',o+='      <label for="inputEmail" class="control-label">Email</label>',o+='      <input type="email" class="form-control" id="inputEmail" placeholder="Email" value="'+(s.role_email||"")+'">',o+='      <span class="form-text text-muted small">Leave blank to prevent user from receiving notifications by email.</span>',o+="    </div>",o+="  </div>",o+='  <div class="row">',o+='    <div class="form-group col-sm-6">',o+='      <label for="inputPassword" class="control-label">Password&#42;</label>',o+='      <input type="password" class="form-control" id="inputPassword" placeholder="Password" />',o+='      <input type="password" class="form-control" id="inputPassword2" placeholder="Confirm password" />',o+='      <p class="form-text text-muted"><small>&#42;: leave this field blank to keep it unchanged.</small></p>',o+="    </div>",o+='    <div class="form-group col-sm-6">',o+='      <label for="selectGroups" class="control-label">Groups</label><br />',o+='      <select id="selectGroups" multiple="multiple">';var l={},a="";for(var i in s.groups)a="",s.in_groups.indexOf(i.name)>-1&&(a="selected"),o+='      <option value="'+i.name+'" '+a+">"+i.name+"</option>",l[i.name]=i.description;o+="      </select><br />",o+='      <label for="selectActive" class="control-label">Active</label><br />',o+='      <select id="selectActive">',o+='        <option value="No">No</options>',sel_active="",s.is_active&&(sel_active="selected"),o+='        <option value="yes" '+sel_active+">Yes</options>",o+="      </select><br />",o+='      <label for="selectAdmin" class="control-label">Administrator</label><br />',o+='      <select id="selectAdmin">',o+='        <option value="No">No</options>',sel_admin="",s.is_admin&&(sel_admin="selected"),o+='        <option value="yes" '+sel_admin+">Yes</options>",o+="      </select>",o+="    </div>",o+="  </div>",o+='  <div class="row">',o+='    <div class="form-group col-sm-6">',o+='      <label for="inputPhone" class="control-label">Phone</label>',o+='      <input type="text" class="form-control" id="inputPhone" placeholder="Phone" value="'+(s.role_phone||"")+'">',o+='      <span class="form-text text-muted small">Leave blank to prevent user from receiving notifications by SMS.</span>',o+="    </div>",o+="  </div>",o+="</form>";e("#"+t+"Body").html(o),e("#"+t+"Footer").html('<button type="submit" id="submitFormUpdateUser" class="btn btn-success">Save</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),e("#submitFormUpdateUser").click(function(){e("#formUpdateUser").submit()}),e("#selectGroups").multiselect(),e(".multiselect-container li").not(".filter, .group").tooltip({placement:"right",container:"body",title:function(){var t=e(this).find("input").val();return l[t]}}),e("#selectActive").multiselect(),e("#selectAdmin").multiselect(),e("#formUpdateUser").submit(function(s){s.preventDefault(),function(t){var s=e("#inputUsername").val();e.ajax({url:"/json/settings/user/"+s,type:"post",beforeSend:function(s){e("#"+t+"Label").html("Processing, please wait..."),e("#"+t+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>')},data:JSON.stringify({new_username:e("#inputNewUsername").val(),email:e("#inputEmail").val(),phone:e("#inputPhone").val(),password:e("#inputPassword").val(),password2:e("#inputPassword2").val(),groups:e("#selectGroups").val(),is_active:e("#selectActive").val(),is_admin:e("#selectAdmin").val()}),async:!0,contentType:"application/json",dataType:"json",success:function(s){e("#"+t).modal("hide");var o=window.location.href;window.location.replace(o)},error:function(s){e("#"+t+"Label").html("Update user properties"),e("#"+t+"Info").html('<div class="alert alert-danger" role="alert">ERROR: '+JSON.parse(s.responseText).error+"</div>")}})}(t)})},error:function(s){e("#"+t+"Label").html("Update user properties"),e("#"+t+"Body").html('<div class="alert alert-danger" role="alert">ERROR: '+JSON.parse(s.responseText).error+"</div>")}})}function a(t,s){e.ajax({url:"/json/settings/user/"+s,type:"get",beforeSend:function(s){e("#"+t+"Label").html("Processing, please wait..."),e("#"+t+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),e("#"+t+"Body").html(""),e("#"+t+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(s){e("#"+t+"Label").html("Delete user confirmation"),e("#"+t+"Body").html(""),e("#"+t+"Footer").html('<button type="submit" id="buttonDeleteUser" class="btn btn-danger">Yes, delete this user</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),e("#buttonDeleteUser").click(function(o){o.preventDefault(),function(t,s){e.ajax({url:"/json/settings/delete/user",type:"post",beforeSend:function(s){e("#"+t+"Label").html("Processing, please wait..."),e("#"+t+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),e("#"+t+"Body").html("")},async:!0,contentType:"application/json",dataType:"json",data:JSON.stringify({username:s}),success:function(s){e("#"+t).modal("hide");var o=window.location.href;window.location.replace(o)},error:function(s){e("#"+t+"Label").html("Delete user confirmation"),e("#"+t+"Info").html('<div class="alert alert-danger" role="alert">ERROR: '+r(JSON.parse(s.responseText).error)+"</div>"),e("#"+t+"Body").html("")}})}(t,s.role_name)})},error:function(s){e("#"+t+"Label").html("Delete user confirmation"),e("#"+t+"Info").html('<div class="alert alert-danger" role="alert">ERROR: '+r(JSON.parse(s.responseText).error)+"</div>"),e("#"+t+"Body").html(""),e("#"+t+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')}})}function i(t){e.ajax({url:"/json/settings/all/group/role",type:"get",beforeSend:function(s){e("#"+t+"Label").html("Processing, please wait..."),e("#"+t+"Info").html(""),e("#"+t+"Body").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>'),e("#"+t+"Footer").html('<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>')},async:!0,contentType:"application/json",dataType:"json",success:function(s){e("#"+t+"Label").html("Add a new user"),e("#"+t+"Info").html("");var o="";o+='<form id="formAddUser">',o+='  <div class="row">',o+='    <div class="form-group col-sm-6">',o+='      <label for="inputNewUsername" class="control-label">Username</label>',o+='      <input type="text" class="form-control" id="inputNewUsername" placeholder="Username" />',o+="    </div>",o+='    <div class="form-group col-sm-6">',o+='      <label for="inputEmail" class="control-label">Email</label>',o+='      <input type="email" class="form-control" id="inputEmail" placeholder="Email" />',o+='      <span class="form-text text-muted small">Leave blank to prevent user from receiving notifications by email.</span>',o+="    </div>",o+="  </div>",o+='  <div class="row">',o+='    <div class="form-group col-sm-6">',o+='      <label for="inputPassword" class="control-label">Password&#42;</label>',o+='      <input type="password" class="form-control" id="inputPassword" placeholder="Password" />',o+='      <input type="password" class="form-control" id="inputPassword2" placeholder="Confirm password" />',o+='      <p class="form-text text-muted"><small>&#42;: leave this field blank to keep it unchanged.</small></p>',o+="    </div>",o+='    <div class="form-group col-sm-6">',o+='      <label for="selectGroups" class="control-label">Groups</label><br />',o+='      <select id="selectGroups" multiple="multiple">';var l={};for(var a in s.groups)o+='      <option value="'+a.name+'">'+a.name+"</option>",l[a.name]=a.description;o+="      </select><br />",o+='      <label for="selectActive" class="control-label">Active</label><br />',o+='      <select id="selectActive">',o+='        <option value="yes" selected>Yes</options>',o+='        <option value="No">No</options>',o+="      </select><br />",o+='      <label for="selectAdmin" class="control-label">Administrator</label><br />',o+='      <select id="selectAdmin">',o+='        <option value="No" selected>No</options>',o+='        <option value="yes">Yes</options>',o+="      </select>",o+="    </div>",o+="  </div>",o+='  <div class="row">',o+='    <div class="form-group col-sm-6">',o+='      <label for="inputPhone" class="control-label">Phone</label>',o+='      <input type="text" class="form-control" id="inputPhone" placeholder="Phone">',o+='      <span class="form-text text-muted small">Leave blank to prevent user from receiving notifications by SMS.</span>',o+="    </div>",o+="  </div>",o+="</form>";e("#"+t+"Body").html(o),e("#"+t+"Footer").html('<button type="submit" id="submitFormAddUser" class="btn btn-success">Save</button> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>'),e("#submitFormAddUser").click(function(){e("#formAddUser").submit()}),e("#selectGroups").multiselect(),e(".multiselect-container li").not(".filter, .group").tooltip({placement:"right",container:"body",title:function(){var t=e(this).find("input").val();return l[t]}}),e("#selectActive").multiselect(),e("#selectAdmin").multiselect(),e("#formAddUser").submit(function(s){s.preventDefault(),function(t){e.ajax({url:"/json/settings/user",type:"post",beforeSend:function(s){e("#"+t+"Label").html("Processing, please wait..."),e("#"+t+"Info").html('<div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Please wait ...</div></div></div></div>')},data:JSON.stringify({new_username:e("#inputNewUsername").val(),email:e("#inputEmail").val(),phone:e("#inputPhone").val(),password:e("#inputPassword").val(),password2:e("#inputPassword2").val(),groups:e("#selectGroups").val(),is_active:e("#selectActive").val(),is_admin:e("#selectAdmin").val()}),async:!0,contentType:"application/json",dataType:"json",success:function(s){e("#"+t).modal("hide");var o=window.location.href;window.location.replace(o)},error:function(s){e("#"+t+"Label").html("Add a new user"),e("#"+t+"Info").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+r(JSON.parse(s.responseText).error)+"</div></div></div>")}})}(t)})},error:function(s){e("#"+t+"Label").html("Add a new user"),e("#"+t+"Info").html('<div class="row"><div class="col-md-12"><div class="alert alert-danger" role="alert">ERROR: '+r(JSON.parse(s.responseText).error)+"</div></div></div>")}})}o()(window,e);var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function r(e){return String(e).replace(/[&<>"'\/]/g,function(e){return n[e]})}e(document).ready(function(){e("#tableUsers").DataTable({stateSave:!0}),e("#buttonLoadAddUserForm").click(function(){e("#UserModal").modal("show"),e("[data-toggle=popover]").popover("hide"),i("UserModal")}),e(document).on("click","[data-action=edit]",function(){e("#UserModal").modal("show"),e("[data-toggle=popover]").popover("hide"),l("UserModal",e(this).data("username"))}),e(document).on("click","[data-action=delete]",function(){e("#UserModal").modal("show"),e("[data-toggle=popover]").popover("hide"),a("UserModal",e(this).data("username"))})})}.call(this,s("./node_modules/jquery/dist/jquery.js"))}},[["./temboardui/static/js/temboard.settings.user.js","runtime","vendors~activity~base~home~notifications~settings.group~settings.instance~settings.user","vendors~activity~notifications~settings.group~settings.instance~settings.user"]]]);